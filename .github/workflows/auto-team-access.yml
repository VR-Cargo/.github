name: Auto-add Team to New Repos

on:
  repository:
    types: [created]

jobs:
  add-team:
    runs-on: ubuntu-latest
    steps:
      - name: Add LoadPlan Dev team with write access
        env:
          GH_TOKEN: ${{ secrets.CROSS_REPO_PAT }}
        run: |
          REPO_NAME="${{ github.event.repository.name }}"
          ORG="VR-Cargo"
          TEAM_SLUG="loadplan-dev"

          echo "Adding team '$TEAM_SLUG' to repo '$REPO_NAME' with write access..."

          gh api -X PUT "orgs/$ORG/teams/$TEAM_SLUG/repos/$ORG/$REPO_NAME" \
            -f permission=push \
            && echo "Successfully added team access" \
            || echo "Failed to add team access"
